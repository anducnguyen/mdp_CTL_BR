%%%transition matrix
function T=transition_collision(Nums1,Numu)

T=zeros(Nums1,Nums1,Numu);

%%%%%%%%%%%%%%%%%%1
%%%%%%%%%%%%%%%%%%1
alf=0.80;

T(1,2,1)=alf;
T(1,1,1)=(1-alf)/2;
T(1,6,1)=(1-alf)/2;


T(1,1,2)=1;

T(1,5,3)=alf;
T(1,6,3)=(1-alf)/2;
T(1,1,3)=(1-alf)/2;

T(1,1,4)=1;


%%%%%%%%%%%%%%%2
T(2,3,1)=alf;
T(2,7,1)=(1-alf)/2;
T(2,2,1)=(1-alf)/2;

T(2,1,2)=alf;
T(2,2,2)=(1-alf)/2;
T(2,5,2)=(1-alf)/2;

T(2,6,3)=alf;
T(2,7,3)=(1-alf)/2;
T(2,5,3)=(1-alf)/2;

T(2,2,4)=1;



%%%%%%%%%%%%%%%%%%3
T(3,4,1)=alf;
T(3,3,1)=(1-alf)/2;
T(3,8,1)=(1-alf)/2;

T(3,2,2)=alf;
T(3,6,2)=(1-alf)/2;
T(3,3,2)=(1-alf)/2;

T(3,7,3)=alf;
T(3,8,3)=(1-alf)/2;
T(3,6,3)=(1-alf)/2;

T(3,3,4)=1;



%%%%%%%%%4
T(4,4,1)=1;

T(4,3,2)=alf;
T(4,7,2)=(1-alf)/2;
T(4,4,2)=(1-alf)/2;

T(4,8,3)=alf;
T(4,7,3)=(1-alf)/2;
T(4,4,3)=(1-alf)/2;

T(4,4,4)=1;




%%%%%%5
T(5,6,1)=alf;
T(5,2,1)=(1-alf)/2;
T(5,10,1)=(1-alf)/2;

T(5,5,2)=1;


T(5,9,3)=alf;
T(5,10,3)=(1-alf)/2;
T(5,5,3)=(1-alf)/2;

T(5,9,4)=alf;
T(5,10,4)=(1-alf)/2;
T(5,5,4)=(1-alf)/2;



%%%%%%%%%6
T(6,7,1)=alf;
T(6,3,1)=(1-alf)/2;
T(6,11,1)=(1-alf)/2;

T(6,5,2)=alf;
T(6,1,2)=(1-alf)/2;
T(6,9,2)=(1-alf)/2;


T(6,10,3)=alf;
T(6,11,3)=(1-alf)/2;
T(6,9,3)=(1-alf)/2;

T(6,2,4)=alf;
T(6,1,4)=(1-alf)/2;
T(6,3,4)=(1-alf)/2;



%%%%%%%%%7
T(7,8,1)=0.95;
T(7,7,1)=0.05;


%%%%%%8
T(8,7,2)=alf;
T(8,11,2)=(1-alf)/2;
T(8,3,2)=(1-alf)/2;

T(8,12,3)=alf;
T(8,11,3)=(1-alf)/2;
T(8,8,3)=(1-alf)/2;

T(8,4,4)=alf;
T(8,3,4)=(1-alf)/2;
T(8,8,4)=(1-alf)/2;

%T(8,8,2)=0.05;



%%%%%%9
T(9,10,1)=alf;
T(9,6,1)=(1-alf)/2;
T(9,14,1)=(1-alf)/2;

T(9,9,2)=1;


T(9,13,3)=alf;
T(9,14,3)=(1-alf)/2;
T(9,9,3)=(1-alf)/2;

T(9,5,4)=alf;
T(9,6,4)=(1-alf)/2;
T(9,9,4)=(1-alf)/2;



%%%%%%%%%10
% T(10,10,1)=0.95;
% T(10,7,1)=0.05/2;
% T(10,15,1)=0.05/2;
% 
% T(10,10,2)=0.95;
% T(10,5,2)=0.05/2;
% T(10,13,2)=0.05/2;
% 
% T(10,10,3)=0.95;
% T(10,13,3)=0.05/2;
% T(10,15,3)=0.05/2;
% 
% T(10,10,4)=0.95;
% T(10,5,4)=0.05/2;
% T(10,13,4)=0.05/2;

T(10,10,1)=1;

%%%%%%%%%11
T(11,11,1)=1;




%%%%%%12
T(12,12,1)=1;

T(12,11,2)=alf;
T(12,7,2)=(1-alf)/2;
T(12,15,2)=(1-alf)/2;


T(12,16,3)=alf;
T(12,15,3)=(1-alf)/2;
T(12,12,3)=(1-alf)/2;

T(12,8,4)=alf;
T(12,7,4)=(1-alf)/2;
T(12,12,4)=(1-alf)/2;


%%%%%%13
T(13,14,1)=alf;
T(13,10,1)=(1-alf)/2;
T(13,13,1)=(1-alf)/2;

T(13,13,2)=1;


T(13,13,3)=1;

T(13,9,4)=alf;
T(13,10,4)=(1-alf)/2;
T(13,13,4)=(1-alf)/2;


%%%%%%%%%14

T(14,15,1)=alf;
T(14,11,1)=(1-alf)/2;
T(14,14,1)=(1-alf)/2;

T(14,13,2)=alf;
T(14,9,2)=(1-alf)/2;
T(14,14,2)=(1-alf)/2;

T(14,14,3)=1;

T(14,10,4)=alf;
T(14,11,4)=(1-alf)/2;
T(14,9,4)=(1-alf)/2;

%%%%%%%%%15
T(15,16,1)=alf;
T(15,12,1)=(1-alf)/2;
T(15,15,1)=(1-alf)/2;

T(15,14,2)=alf;
T(15,10,2)=(1-alf)/2;
T(15,15,2)=(1-alf)/2;

T(15,15,3)=1;

T(15,11,4)=alf;
T(15,12,4)=(1-alf)/2;
T(15,10,4)=(1-alf)/2;

%%%%%%16
T(16,16,1)=1;

% T(16,15,2)=alf;
% T(16,11,2)=(1-alf)/2;
% T(16,16,2)=(1-alf)/2;
T(16,16,2)=1;
T(16,16,3)=1;
T(16,16,4)=1;
% T(16,12,4)=alf;
% T(16,11,4)=(1-alf)/2;
% T(16,16,4)=(1-alf)/2;
end

